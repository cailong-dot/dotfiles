# These settings were set by the catalyst build script that automatically
# built this stage.
# Please consult /usr/share/portage/config/make.conf.example for a more
# detailed example.
COMMON_FLAGS="-march=native -O2 -pipe -finline-functions"

RUSTFLAGS="-C target-cpu=native -C link-arg=-Wl,-z,pack-relative-relocs"

CFLAGS="${COMMON_FLAGS}"
CXXFLAGS="${COMMON_FLAGS}"
FCFLAGS="${COMMON_FLAGS}"
FFLAGS="${COMMON_FLAGS}"

#CGO_CFLAGS="${CFLAGS}"
#CGO_CXXFLAGS="${CXXFLAGS}"
#CGO_FFLAGS="${FFLAGS}"
#CGO_LDFLAGS="${LDFLAGS}"

CHOST="x86_64-pc-linux-gnu"   #直接填写即可
CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt rdrand sse sse2 sse3 sse4_1 sse4_2 ssse3"  
# CPU指令集，按照自己CPU的实际情况填写，后文会提到
#LDFLAGS="${COMMON_FLAGS} -Wl,-O2 -Wl,--as-needed -Wl,--hash-style=gnu -Wl,--sort-common -Wl,--strip-all"
MAKEOPTS="-j10 -l10"                # 同时编译的线程数
CHOST="x86_64-pc-linux-gnu"
EMERGE_DEFAULT_OPTS="--with-bdeps=y --ask --verbose=y --load-average --keep-going --deep"

# NOTE: This stage was built with the bindist Use flag enabled
PORTDIR="/var/db/repos/gentoo"
DISTDIR="/var/cache/distfiles"
PKGDIR="/var/cache/binpkgs"
PORTAGE_TMPDIR="/tmp"
DARKELF_FEATURES="postmerge_distclean"

# This sets the language of build output to English.
# Please keep this setting intact when reporting bugs.
LC_MESSAGES=C

# Emerge Default Option
EMERGE_DEFAULT_OPTS="--keep-going --with-bdeps=y --quiet --ask --verbose"   # emerge的默认选项
AUTO_CLEAN="yes"  #每次安装完包之后自动清理

# Accept
ACCEPT_KEYWORDS="~amd64"           # 如果你更喜欢稳定而非最新那这里用amd64
ACCEPT_LICENSE="*"                 # 接受所有许可证的软件

# Lang
L10N="zh-CN zh" 
#L10N="en-US zh-CN en zh"           # 语言设置照抄即可
LINGUAS="en-US zh-CN en zh"

# Harkware
VIDEO_CARDS="intel i965 iris nvidia"    # intel集成显卡和nvidia显卡（不使用novueau）
ALSA_CARDS="hda-intel"             # intel声卡
INPUT_DEVICES="libinput synaptics" # 输入设备 非笔记本去除后面的synaptics
MICROCODE_SIGNATURES="-S"		# CPU的microcode直接编译进内核

#Grub
GRUB_PLATFORMS="efi-64"            # 设置GRUB版本 照抄即可

# Ccache
# FEATURES="parallel-fetch ccache"   # 使用ccache来大大提高重新编译时的速度，等后面安装并设置ccache之后取消注释
# CCACHE_DIR="/var/cache/ccache"     # ccache使用的目录

# Aria2                             # 使用aria2提高下载速度（不设置也无大碍，设置的话一定要注意指令拼写正确）
#FETCHCOMMAND="/usr/bin/aria2c -d \${DISTDIR} -o \${FILE} --allow-overwrite=true --max-tries=5 --max-file-not-found=2 --max-concurrent-downloads=5 --connect-timeout=5  --timeout=5 --split=5 --min-split-size=2M --lowest-speed-limit=20K --max-connection-per-server=9 --uri-selector=feedback \${URI}"
#RESUMECOMMAND="${FETCHCOMMAND}"

# USE                               # USE变量是Gentoo最有威力的变量 也是Gentoo吸引我的原因之一
FUCKDE="-gnome -gnome-shell -gnome-keyring -nautilus -kde"
# 不打算安装gnome和kde及其相关组件
FUCKSV="-bindist -mdev elogind -dhcpcd -oss grub -plymouth -systemd -consolekit"
# 不使用systemd plymouth consolekit 只使用elogind（旧教程会使用consolekit，事实上elogind是consolekit未来的替代品）
SOFTWARE="sudo icu client git chromium openmp minizip udev blkid efi hwdb smack acpi ccache dbus policykit udisks fortran lto pgo graphite jumbo-build"
# 需要用到的特性 照抄即可
AUDIO="alsa jack pulseaudio minimal libsamplerate -oss"
# 对于音频相关软件使用pulseaudio alsa jack特性
#NET="network networkmanager modemmanager iptables jansson werror elogind resolvconf dhcpcanon dhcpcd ifupdown ifcfg_rh libpsl wifi http2"
NET="networkmanager iwd connection-sharing -dhclient nftables -iptables policykit ppp wifi dhcpcd resolvconf"
# 网络相关 照抄即可
VIDEO="X vulkan layers glamor nvidia gallium kms libglvnd vaapi vdpau x264 x265 gtk3 imagemagick postscript webp jpeg2k ffmpeg" 
# 图形相关 照抄即可
BROWSER="firefox ssl"
# Browser
ELSE="cjk emoji firmware v4l -savedconfig"
# 照抄
USE="${FUCKDE} ${FUCKSV} ${SOFTWARE} ${AUDIO} ${NET} ${VIDEO} ${BROWSER} ${ELSE}"
# 定义需要的USE变量

# Mirrors
#GENTOO_MIRRORS="https://mirrors.bfsu.edu.cn/gentoo" # 设置镜像站为北外镜像站（清华镜像站的影分身，压力小，速度快）
GENTOO_MIRRORS="https://mirrors.aliyun.com/gentoo"

#FEATURES="-strict -assume-digests -sign" # 


#GENTOO_MIRRORS="https://mirrors.aliyun.com/gentoo/ \
#    https://mirrors.163.com/gentoo/ \
#    https://mirrors.tuna.tsinghua.edu.cn/gentoo"
